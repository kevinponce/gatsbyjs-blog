{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/monitor-resque-in-code/","result":{"data":{"site":{"siteMetadata":{"title":"Kevin Ponce Blog","author":"Kevin Ponce"}},"markdownRemark":{"id":"1e5b97bc-c3a7-5890-b6bd-7db7e47b9fda","excerpt":"Resque is amazing but sometimes it get a little backed up.\nHere is how you can easily access resque details inside or ruby. To get an overview of resque run theâ€¦","html":"<p>Resque is amazing but sometimes it get a little backed up.\nHere is how you can easily access resque details inside or ruby.</p>\n<p>To get an overview of resque run the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">'resque'</span>\n<span class=\"token constant\">Resque</span><span class=\"token punctuation\">.</span>info</code></pre></div>\n<p>Response:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token punctuation\">{</span>\n  <span class=\"token symbol\">:pending</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:processed</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:queues</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:workers</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:working</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:failed</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:servers</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token string\">\"redis://192.168.1.10:6379/0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token symbol\">:environment</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"production\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you want to only know how many pending jobs are waiting to be processed, run:</p>\n<p>Note this will work with all of the keys return from above(<code class=\"language-text\">pending</code>, <code class=\"language-text\">processed</code>, <code class=\"language-text\">queues</code>, <code class=\"language-text\">workers</code>, <code class=\"language-text\">working</code>, <code class=\"language-text\">failed</code>, <code class=\"language-text\">servers</code>, <code class=\"language-text\">environment</code>)</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">'resque'</span>\n<span class=\"token constant\">Resque</span><span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">[</span><span class=\"token symbol\">:pending</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Response:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token number\">100</span></code></pre></div>\n<p><code class=\"language-text\">Resque.info</code> is very useful but it will not let you know where to problem is located.\nYou will have to use queues to determine which is backed up</p>\n<p>Here is how to get a list of queues:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">'resque'</span>\n<span class=\"token constant\">Resque</span><span class=\"token punctuation\">.</span>queues</code></pre></div>\n<p>Response:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token punctuation\">[</span><span class=\"token string\">\"example1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"example2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"example3\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Once you know which queue you want to investage, you can get the size of it:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">'resque'</span>\n<span class=\"token constant\">Resque</span><span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">(</span><span class=\"token string\">'example1'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Response:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token number\">100</span></code></pre></div>\n<p>Now you know how to check on the size of a queue, you can send a text message using twilio or auto scale using heroku platform-api formation.</p>","frontmatter":{"title":"Monitor Resque In Code","date":"2020-01-24T22:12:00.121Z","description":"How to monitor resque from in ruby code so you can automatically handle scaling or send a text if it hits a certain threshold","author":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/monitor-resque-in-code/","previous":{"fields":{"slug":"/heroku-scale-dyno-from-ruby/"},"frontmatter":{"title":"Heroku Scale Dyno From Ruby","tags":["ruby","ruby-on-rails"]}},"next":{"fields":{"slug":"/ruby-import-large-data-in-bulk/"},"frontmatter":{"title":"Ruby Import Large Amounts of Data in Bulk","tags":["ruby","ruby-on-rails"]}}}}}