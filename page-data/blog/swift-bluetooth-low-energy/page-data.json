{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/swift-bluetooth-low-energy/","webpackCompilationHash":"4345e2f2e96b614a424f","result":{"data":{"site":{"siteMetadata":{"title":"Kevin Ponce Blog","author":"Kevin Ponce"}},"markdownRemark":{"id":"6c515f3f-4535-5107-ada9-f28524b04de2","excerpt":"I was recently working on a project and need to connect my cell phone to and android controller. Here is a snippet of swift code that I used to achieve this.","html":"<p>I was recently working on a project and need to connect my cell phone to and android controller.</p>\n<p>Here is a snippet of swift code that I used to achieve this.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">UIKit</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">CoreBluetooth</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">BluetooptheViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">CBCentralManagerDelegate</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">CBPeripheralDelegate</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> manager<span class=\"token punctuation\">:</span><span class=\"token builtin\">CBCentralManager</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n  <span class=\"token keyword\">var</span> mainPeripheral<span class=\"token punctuation\">:</span><span class=\"token builtin\">CBPeripheral</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n  <span class=\"token keyword\">var</span> mainCharacteristic<span class=\"token punctuation\">:</span><span class=\"token builtin\">CBCharacteristic</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n  <span class=\"token keyword\">var</span> peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token operator\">?</span>\n  <span class=\"token keyword\">var</span> characteristic<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCharacteristic</span><span class=\"token operator\">?</span>\n  <span class=\"token keyword\">var</span> ready <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token atrule\">@IBAction</span> <span class=\"token keyword\">func</span> <span class=\"token function\">buttonPressed</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> sender<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ready<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> c <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>characteristic <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>using<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">Encoding</span><span class=\"token punctuation\">.</span>utf8<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>peripheral<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">writeValue</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> c<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCharacteristicWriteType</span><span class=\"token punctuation\">.</span>withoutResponse<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">var</span> serviceUUID <span class=\"token operator\">=</span> <span class=\"token function\">CBUUID</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">:</span> <span class=\"token string\">\"FFE0\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">var</span> characteristicUUID <span class=\"token operator\">=</span> <span class=\"token function\">CBUUID</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">:</span> <span class=\"token string\">\"FFE1\"</span><span class=\"token punctuation\">)</span>\n  \n  <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    manager <span class=\"token operator\">=</span> <span class=\"token function\">CBCentralManager</span><span class=\"token punctuation\">(</span>delegate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> queue<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    manager<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>delegate <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">centralManagerDidUpdateState</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> central<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCentralManager</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span> central<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token builtin\">CBManagerState</span><span class=\"token punctuation\">.</span>poweredOn<span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>manager<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">scanForPeripherals</span><span class=\"token punctuation\">(</span>withServices<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>serviceUUID<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">break</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">centralManager</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> central<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCentralManager</span><span class=\"token punctuation\">,</span> didDiscover peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token punctuation\">,</span> advertisementData<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">String</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> rssi <span class=\"token constant\">RSSI</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSNumber</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>manager<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">stopScan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>peripheral <span class=\"token operator\">=</span> peripheral<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>manager<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>peripheral<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">centralManager</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> central<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCentralManager</span><span class=\"token punctuation\">,</span> didConnect peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    peripheral<span class=\"token punctuation\">.</span>delegate <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span>\n    peripheral<span class=\"token punctuation\">.</span><span class=\"token function\">discoverServices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>serviceUUID<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">peripheral</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token punctuation\">,</span> didDiscoverServices error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> service <span class=\"token operator\">=</span> peripheral<span class=\"token punctuation\">.</span>services<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">where</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> $<span class=\"token number\">0</span><span class=\"token punctuation\">.</span>uuid <span class=\"token operator\">==</span> serviceUUID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      peripheral<span class=\"token punctuation\">.</span><span class=\"token function\">discoverCharacteristics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> service<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">peripheral</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token punctuation\">,</span> didDiscoverCharacteristicsFor service<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBService</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> characteristic <span class=\"token operator\">=</span> service<span class=\"token punctuation\">.</span>characteristics<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">where</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> $<span class=\"token number\">0</span><span class=\"token punctuation\">.</span>uuid <span class=\"token operator\">==</span> characteristicUUID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      peripheral<span class=\"token punctuation\">.</span><span class=\"token function\">setNotifyValue</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> characteristic<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>characteristic <span class=\"token operator\">=</span> characteristic\n      <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>ready <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">peripheral</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token punctuation\">,</span> didUpdateValueFor characteristic<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCharacteristic</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> str <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span> characteristic<span class=\"token punctuation\">.</span>value<span class=\"token operator\">!</span><span class=\"token punctuation\">,</span> encoding<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">Encoding</span><span class=\"token punctuation\">.</span>utf8<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">func</span> <span class=\"token function\">peripheral</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> peripheral<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBPeripheral</span><span class=\"token punctuation\">,</span> didWriteValueFor characteristic<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CBCharacteristic</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> error <span class=\"token operator\">!=</span> <span class=\"token constant\">nil</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error while writing value to <span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>characteristic<span class=\"token punctuation\">.</span>uuid<span class=\"token punctuation\">.</span>uuidString<span class=\"token delimiter variable\">)</span></span>: <span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>error<span class=\"token punctuation\">.</span>debugDescription<span class=\"token delimiter variable\">)</span></span>\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"didWriteValueFor <span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>characteristic<span class=\"token punctuation\">.</span>uuid<span class=\"token punctuation\">.</span>uuidString<span class=\"token delimiter variable\">)</span></span>\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"Swift Bluetooth Low Energy","date":"September 12, 2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/swift-bluetooth-low-energy/","previous":{"fields":{"slug":"/heroku-static-website/"},"frontmatter":{"title":"Heroku static website","tags":["html"]}},"next":{"fields":{"slug":"/end-and-beginning-of-file-iterm/"},"frontmatter":{"title":"End and Beginning of File iTerm","tags":["iterm"]}}}}}