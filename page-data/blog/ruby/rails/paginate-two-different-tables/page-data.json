{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/ruby/rails/paginate-two-different-tables/","result":{"data":{"site":{"siteMetadata":{"title":"Kevin Ponce Blog","author":"Kevin Ponce"}},"markdownRemark":{"id":"23dc34a2-98b4-5262-a8f9-f8d2ee770c50","excerpt":"Sometimes when your developing, you have to do something that seems so wrong, but do to a deadline or for some other reason are left with no options…\nThis is an…","html":"<p>Sometimes when your developing, you have to do something that seems so wrong, but do to a deadline or for some other reason are left with no options…\nThis is an example of this.</p>\n<p>Here is how to paginate two different tables in rails:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">page <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nper_page <span class=\"token operator\">=</span> <span class=\"token number\">25</span>\n\nfetch_example_time_and_ids <span class=\"token operator\">=</span> <span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"`id`, `created_at`, '<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>name<span class=\"token delimiter tag\">}</span></span>' AS kind\"</span><span class=\"token punctuation\">)</span>\nfetch_other_example_time_and_ids <span class=\"token operator\">=</span> <span class=\"token constant\">OtherExample</span><span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"`id`, `created_at`, '<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token constant\">OtherExample</span><span class=\"token punctuation\">.</span>name<span class=\"token delimiter tag\">}</span></span>' AS kind\"</span><span class=\"token punctuation\">)</span>\nsub_query <span class=\"token operator\">=</span> fetch_example_time_and_ids<span class=\"token punctuation\">.</span>union<span class=\"token punctuation\">(</span>fetch_other_example_time_and_ids<span class=\"token punctuation\">)</span>\n\nunion_examples <span class=\"token operator\">=</span> <span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>from<span class=\"token punctuation\">(</span>sub_query<span class=\"token punctuation\">,</span> <span class=\"token string\">'t'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">(</span><span class=\"token string\">\"`t`.`created_at` ASC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paginate<span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">:</span> page<span class=\"token punctuation\">,</span> per_page<span class=\"token punctuation\">:</span> per_page<span class=\"token punctuation\">)</span>\n\nexample_ids <span class=\"token operator\">=</span> union_examples<span class=\"token punctuation\">.</span>to_a<span class=\"token punctuation\">.</span>inject<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OtherExample</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>results<span class=\"token punctuation\">,</span> union_example<span class=\"token operator\">|</span>\n  results<span class=\"token punctuation\">[</span>union_example<span class=\"token punctuation\">[</span><span class=\"token symbol\">:kind</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>push union_example<span class=\"token punctuation\">.</span>id\n  results\n<span class=\"token keyword\">end</span>\n\n<span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>examples <span class=\"token operator\">=</span> <span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">:</span> example_ids<span class=\"token punctuation\">[</span><span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>full_context<span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">(</span><span class=\"token string\">\"`created_at` ASC\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> example_ids<span class=\"token punctuation\">[</span><span class=\"token constant\">Example</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>present<span class=\"token operator\">?</span>\n<span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>other_examples <span class=\"token operator\">=</span> <span class=\"token constant\">OtherExample</span><span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">:</span> example_ids<span class=\"token punctuation\">[</span><span class=\"token constant\">OtherExample</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">(</span><span class=\"token string\">\"`created_at` ASC\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> example_ids<span class=\"token punctuation\">[</span><span class=\"token constant\">OtherExample</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>present<span class=\"token operator\">?</span></code></pre></div>","frontmatter":{"title":"Paginate two different tables in rails","date":"November 22, 2020","description":"How to paginate two different tables in rails","author":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/ruby/rails/paginate-two-different-tables/","previous":{"fields":{"slug":"/ruby/rails/clobber-webpacker-files/"},"frontmatter":{"title":"Rails clobber webpacker files","tags":["ruby","ruby-on-rails"]}},"next":{"fields":{"slug":"/ruby/ruby-create-hash-of-arrays/"},"frontmatter":{"title":"Ruby create hash of arrays","tags":["ruby","ruby-on-rails"]}}}}}