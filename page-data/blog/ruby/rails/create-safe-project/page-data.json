{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/ruby/rails/create-safe-project/","result":{"data":{"site":{"siteMetadata":{"title":"Kevin Ponce Blog","author":"Kevin Ponce"}},"markdownRemark":{"id":"f26032ed-e4d8-53cb-bb86-04aa50125c78","excerpt":"Create Application First you need to create new project by running the following command in a terminal:   adds webpacker and configures it to work with react…","html":"<h2>Create Application</h2>\n<p>First you need to create new project by running the following command in a terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rails new app-name --webpack=react -T -d postgresql</code></pre></div>\n<p><code class=\"language-text\">--webpack=react</code>  adds webpacker and configures it to work with react\n<code class=\"language-text\">-T</code> will prevent creating minitest test\n<code class=\"language-text\">-d postgresql</code> will create rails project with postgresql instead of sqlite</p>\n<h2>Update <code class=\"language-text\">development</code> and <code class=\"language-text\">test</code> gems</h2>\n<p>Next you need update <code class=\"language-text\">Gemfile</code> to have the following in group <code class=\"language-text\">:development, :test</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">group <span class=\"token symbol\">:development</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:test</span> <span class=\"token keyword\">do</span>\n  gem <span class=\"token string\">'brakeman'</span>\n  gem <span class=\"token string\">'bullet'</span>\n  gem <span class=\"token string\">'bundler-audit'</span>\n  gem <span class=\"token string\">'byebug'</span><span class=\"token punctuation\">,</span> platforms<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token symbol\">:mri</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:mingw</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:x64_mingw</span><span class=\"token punctuation\">]</span>\n  gem <span class=\"token string\">'database_cleaner'</span>\n  gem <span class=\"token string\">'factory_bot_rails'</span>\n  gem <span class=\"token string\">'rspec-rails'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'~> 3.5'</span>\n  gem <span class=\"token string\">'rubocop'</span>\n  gem <span class=\"token string\">'simplecov'</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>To install the gems, run the following command in a terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">bundle install</code></pre></div>\n<h3>Rspec</h3>\n<p>Rspec is a test framework for ruby that makes it simple to test a application.\nTo setup rspec, run the following command in a terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">rails generate rspec<span class=\"token symbol\">:install</span></code></pre></div>\n<p>When you add integrate a gem into Rspec, it is best to add it under support.\nTo setup rspec to work with support add the following:</p>\n<ol>\n<li>Uncomment out <code class=\"language-text\">Dir[Rails.root.join(&#39;spec&#39;, &#39;support&#39;, &#39;**&#39;, &#39;*.rb&#39;)].each { |f| require f }</code> in <code class=\"language-text\">spec/rails_helper.rb</code></li>\n<li>Creatre folder <code class=\"language-text\">spec/support</code></li>\n</ol>\n<h3>Factory Bot</h3>\n<p>Factory Bot provides factory methods to create test fixtures for automated software testing.\nIt makes it easy to create, or build data for tests in ruby.</p>\n<p>Create a support file to add Factory Bot to Rspec by doing the following to <code class=\"language-text\">spec/support/factory_bot.rb</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># frozen_string_literal: true</span>\n\n<span class=\"token constant\">RSpec</span><span class=\"token punctuation\">.</span>configure <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>config<span class=\"token operator\">|</span>\n  config<span class=\"token punctuation\">.</span>include <span class=\"token constant\">FactoryBot</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Syntax</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Methods</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<h1>Database Cleaner</h1>\n<p>Database Cleaner is a set of gems containing strategies for cleaning your database in Ruby.\nCreate a support file to add Database Cleaner to Rspec by doing the following to <code class=\"language-text\">spec/support/database_cleaner.rb</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># frozen_string_literal: true</span>\n\n<span class=\"token constant\">RSpec</span><span class=\"token punctuation\">.</span>configure <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>config<span class=\"token operator\">|</span>\n  config<span class=\"token punctuation\">.</span>before<span class=\"token punctuation\">(</span><span class=\"token symbol\">:suite</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token constant\">DatabaseCleaner</span><span class=\"token punctuation\">.</span>strategy <span class=\"token operator\">=</span> <span class=\"token symbol\">:transaction</span>\n    <span class=\"token constant\">DatabaseCleaner</span><span class=\"token punctuation\">.</span>clean_with<span class=\"token punctuation\">(</span><span class=\"token symbol\">:truncation</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  config<span class=\"token punctuation\">.</span>around<span class=\"token punctuation\">(</span><span class=\"token symbol\">:each</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>example<span class=\"token operator\">|</span>\n    <span class=\"token constant\">DatabaseCleaner</span><span class=\"token punctuation\">.</span>cleaning <span class=\"token keyword\">do</span>\n      example<span class=\"token punctuation\">.</span>run\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<h3>Brakeman</h3>\n<p>Brakeman is a static analysis tool which checks Ruby on Rails applications for security vulnerabilities.\nThere is not integration for rspec.\nTo run Brakeman, run the following command in a terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">bundle exec brakeman</code></pre></div>\n<h3>Bullet</h3>\n<p>The Bullet gem is designed to help you increase your application’s performance by reducing the number of queries it makes.\nThis gem helps find a lot of potenial performance issues.</p>\n<p>To add Bullet add the following snippet code to <code class=\"language-text\">config/environments/development.rb</code> and <code class=\"language-text\">config/environments/test.rb</code></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>application<span class=\"token punctuation\">.</span>configure <span class=\"token keyword\">do</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n  config<span class=\"token punctuation\">.</span>after_initialize <span class=\"token keyword\">do</span>\n    <span class=\"token constant\">Bullet</span><span class=\"token punctuation\">.</span>enable <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span>\n    <span class=\"token constant\">Bullet</span><span class=\"token punctuation\">.</span>bullet_logger <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span>\n    <span class=\"token constant\">Bullet</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">raise</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span> <span class=\"token comment\"># raise an error if n+1 query occurs</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<h3>Bundler Audit</h3>\n<p>Bundler Audit checks for vulnerable versions of gems in Gemfile.lock.\nThis is important because we often add gems to make our live easier but are not able to keep up with vulnerable in all of our gems.\nTo run Bundler Audit, run the following command in a terminal:\n<code class=\"language-text\">bundle exec bundle-audit</code></p>\n<h3>Rubocop</h3>\n<p>RuboCop is a Ruby static code analyzer and code formatter.\nThis will enforce many of the guidelines.\nTo run Rubocop, run the following command in a terminal:\n<code class=\"language-text\">bundle exec rubocop</code></p>\n<h3>Simplecov</h3>\n<p>SimpleCov is a code coverage analysis tool for Ruby.\nIt allows you to see how well your coverage is.\nCreate a support file to add Simplecov to Rspec by doing the following to <code class=\"language-text\">spec/support/simplecov.rb</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># frozen_string_literal: true</span>\n\n<span class=\"token keyword\">require</span> <span class=\"token string\">'simplecov'</span>\n\n<span class=\"token constant\">SimpleCov</span><span class=\"token punctuation\">.</span>start</code></pre></div>\n<p>To see areas you need to improve by opening the following file in your browser <code class=\"language-text\">coverage/index.html</code>\nMake sure to add <code class=\"language-text\">/coverage/</code> to <code class=\"language-text\">.gitignore</code>.</p>\n<h1>Run</h1>\n<p>To make see if everything is good with your application run the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">bundle exec rspec\nbundle exec brakeman\nbundle exec bundle<span class=\"token operator\">-</span>audit\nbundle exec rubocop</code></pre></div>\n<h1>Database</h1>\n<p>Before you can run your application, you need to make sure your database is create and your migrations up to date.\nThis can be done by running the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">bundle exec rails db<span class=\"token symbol\">:create</span>\nbundle exec rails db<span class=\"token symbol\">:migrate</span></code></pre></div>\n<p>Last but not least, to your application run the following command in a terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">bundle exec rails s</code></pre></div>","frontmatter":{"title":"Create Safe Rails","date":"August 03, 2019","description":"Learn how to create a safe rails app that will help find vulnerabilities, performance issues, and well tested. You will setup rspec, brakeman, bullet, bundler-audit, database_cleaner, rubocop, and simplecov.","author":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/ruby/rails/create-safe-project/","previous":{"fields":{"slug":"/gatsby/creating-blog/"},"frontmatter":{"title":"Creating blog with Gatsby","tags":["javascript","gatsby"]}},"next":{"fields":{"slug":"/gatsby/add-sass/"},"frontmatter":{"title":"Add Sass to Gatsby","tags":["javascript","gatsby"]}}}}}