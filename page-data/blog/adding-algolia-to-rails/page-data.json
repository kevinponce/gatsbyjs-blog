{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/adding-algolia-to-rails/","result":{"data":{"site":{"siteMetadata":{"title":"Kevin Ponce Blog","author":"Kevin Ponce"}},"markdownRemark":{"id":"b656ddf4-2105-5a4c-ace9-13ecd9e1818f","excerpt":"Only twice in my career, I was amazed with how simple integrating with a third party library.\nAlgolia has done an amazing job with their gem. To get started run…","html":"<p>Only twice in my career, I was amazed with how simple integrating with a third party library.\nAlgolia has done an amazing job with their gem.</p>\n<p>To get started run:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gem install algoliasearch-rails</code></pre></div>\n<p>I personal use <code class=\"language-text\">dotenv</code> gem to store my secrets.\nAdd algolia app id and api key to <code class=\"language-text\">.env</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ALGOLIA_SEARCH_APP_ID=XXXXXXXXXX\nALGOLIA_SEARCH_API_KEY=XXXXXXXXX</code></pre></div>\n<p>Add the following file to <code class=\"language-text\">config/initializers/algolia.rb</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># config/initializers/algolia.rb</span>\n<span class=\"token constant\">AlgoliaSearch</span><span class=\"token punctuation\">.</span>configuration <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  application_id<span class=\"token punctuation\">:</span> <span class=\"token constant\">ENV</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ALGOLIA_SEARCH_APP_ID'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  api_key<span class=\"token punctuation\">:</span> <span class=\"token constant\">ENV</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ALGOLIA_SEARCH_API_KEY'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  connect_timeout<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  receive_timeout<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n  send_timeout<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n  batch_timeout<span class=\"token punctuation\">:</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span>\n  search_timeout<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I personally am not a fan of sending all of your data to algolia, so recommend sending the attributes you need.\nTo add algolia to your user model do the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">ApplicationRecord</span>\n  include <span class=\"token constant\">AlgoliaSearch</span>\n\n  algoliasearch <span class=\"token keyword\">do</span>\n    attributes <span class=\"token symbol\">:id</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:first_name</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:last_name</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:email</span>\n    searchableAttributes <span class=\"token punctuation\">[</span><span class=\"token symbol\">:first_name</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:last_name</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:email</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>Run the following command in rails console to reindex all of your users in algolia.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">User</span><span class=\"token punctuation\">.</span>reindex<span class=\"token operator\">!</span></code></pre></div>\n<p>Run the following command to search:\n<code class=\"language-text\"></code>ruby\nUser.algolia_search(‘kevin’)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">If you have a lot of data, you will need paginate.\nTo do this you need to update `config/initializers/algolia.rb` to specify: `kaminari` or `will_paginate`</code></pre></div>\n<h1>config/initializers/algolia.rb</h1>\n<p>pagination_backend: :kaminari,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">OR</code></pre></div>\n<h1>config/initializers/algolia.rb</h1>\n<p>pagination<em>backend: :will</em>paginate,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Now add pagination to your search, change your algolia search to include `hitsPerPage` and `page`.\n```ruby\nUser.algolia_search(&#39;kevin&#39;, hitsPerPage: 2, page: 1)</code></pre></div>\n<p>There you go.\nA simple crash course on alogia.\nIf you need more details about alogia rails gem check it out <a href=\"https://github.com/algolia/algoliasearch-rails\">https://github.com/algolia/algoliasearch-rails</a></p>","frontmatter":{"title":"Adding Algolia to Rails","date":"August 07, 2019","description":"How to add search to ruby on rails using Algolia which will simply search queries and speed up search results.","author":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/adding-algolia-to-rails/","previous":{"fields":{"slug":"/add-tags-to-gatsby/"},"frontmatter":{"title":"Add Tags to Gatsby","tags":["javascript","gatsby"]}},"next":{"fields":{"slug":"/algolia-react/"},"frontmatter":{"title":"Algolia React","tags":["javascript"]}}}}}