{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/rails-export-import-users/","result":{"data":{"site":{"siteMetadata":{"title":"Kevin Ponce Blog","author":"Kevin Ponce"}},"markdownRemark":{"id":"e31b70b5-8e9d-5ec1-b9b9-63a87e07002c","excerpt":"Here is a simple script to export and import users in rails.\nCopy and past the following code to . To export users run: To import users run:","html":"<p>Here is a simple script to export and import users in rails.\nCopy and past the following code to <code class=\"language-text\">lib/data.rake</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># lib/data.rake</span>\nnamespace <span class=\"token symbol\">:data</span> <span class=\"token keyword\">do</span>\n  namespace <span class=\"token symbol\">:export</span> <span class=\"token keyword\">do</span>\n    desc <span class=\"token string\">'export users'</span>\n    task users<span class=\"token punctuation\">:</span> <span class=\"token symbol\">:environment</span> <span class=\"token keyword\">do</span>\n      dir <span class=\"token operator\">=</span> <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> <span class=\"token string\">'data'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token constant\">FileUtils</span><span class=\"token punctuation\">.</span>mkdir_p<span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span> <span class=\"token keyword\">unless</span> <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>directory<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span>\n\n      filepath <span class=\"token operator\">=</span> <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> <span class=\"token string\">'data'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'users.json'</span><span class=\"token punctuation\">)</span>\n\n      users <span class=\"token operator\">=</span> <span class=\"token constant\">User</span><span class=\"token punctuation\">.</span>all\n      <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>open<span class=\"token punctuation\">(</span>filepath<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>f<span class=\"token operator\">|</span>\n        users<span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>u<span class=\"token operator\">|</span>\n          f<span class=\"token punctuation\">.</span>puts u<span class=\"token punctuation\">.</span>to_json\n        <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">end</span>\n\n      puts <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>users<span class=\"token punctuation\">.</span>size<span class=\"token delimiter tag\">}</span></span> users export to <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>filepath<span class=\"token delimiter tag\">}</span></span>\"</span>\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n\n  namespace <span class=\"token symbol\">:import</span> <span class=\"token keyword\">do</span>\n    desc <span class=\"token string\">'import users'</span>\n    task users<span class=\"token punctuation\">:</span> <span class=\"token symbol\">:environment</span> <span class=\"token keyword\">do</span>\n      filepath <span class=\"token operator\">=</span> <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> <span class=\"token string\">'data'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'users.json'</span><span class=\"token punctuation\">)</span>\n      abort <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>filepath<span class=\"token delimiter tag\">}</span></span> does not exist\"</span> <span class=\"token keyword\">unless</span> <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>exist<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>filepath<span class=\"token punctuation\">)</span>\n\n      <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span>filepath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>user_str<span class=\"token operator\">|</span>\n        user <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">(</span>user_str<span class=\"token punctuation\">)</span>\n\n        <span class=\"token constant\">User</span><span class=\"token punctuation\">.</span>create<span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">end</span>\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>To export users run:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rails data:export:users</code></pre></div>\n<p>To import users run:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rails data:import:users</code></pre></div>","frontmatter":{"title":"Rails export/import users","date":"August 03, 2019","description":"How to export and import json files with active record","author":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/rails-export-import-users/","previous":{"fields":{"slug":"/pass-jbuilder-to-gon/"},"frontmatter":{"title":"Pass Jbuilder to gon","tags":["ruby","ruby-on-rails"]}},"next":{"fields":{"slug":"/tensorflow-image-recognition-on-mac/"},"frontmatter":{"title":"Tensorflow image recognition on mac","tags":["python"]}}}}}